<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Storytelling con Datos: Tabla de Gesti√≥n</title>
    <style>
        /* --- ESTILOS INSPIRADOS EN STORYTELLING WITH DATA --- */
        /* Objetivo: Minimalismo, claridad y guiar la mirada */

        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, system-ui, -apple-system, 'Helvetica Neue', sans-serif;
        }

        body {
            background: #f5f7fa; /* Fondo suave para que la tabla resalte */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 30px 20px;
            padding: 0;
        }

        .table-container {
            width: 100%;
            max-width: 1300px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); /* Sombra suave para dar profundidad */
            padding: 24px 20px;
            transition: all 0.2s ease;
        }

        h2 {
            font-weight: 400;
            font-size: 1.8rem;
            color: #1a2639;
            margin: 0 0 5px 0;
            letter-spacing: -0.02em;
        }

        .subtitle {
            color: #5a6c7e;
            margin-top: 0;
            margin-bottom: 25px;
            font-size: 0.95rem;
            border-left: 4px solid #2e7ab3;
            padding-left: 15px;
            background: #f0f6fb;
            border-radius: 0 8px 8px 0;
            line-height: 1.4;
            width: fit-content;
            padding: 8px 20px;
        }

        .subtitle code {
            background: #d4e3f0;
            padding: 2px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            color: #1f4e7a;
        }

        /* --- LA TABLA: SIN BORDES VERTICALES, SOLO JERARQU√çA HORIZONTAL --- */
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
            line-height: 1.5;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.03);
        }

        /* Cabecera: Fondo oscuro pero no negro, texto claro */
        th {
            background-color: #2c3e50; /* Azul gris√°ceo oscuro */
            color: white;
            font-weight: 500;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 16px 8px;
            white-space: nowrap;
            text-align: center;
            border-right: 1px solid #3f5568;
        }

        th:last-child {
            border-right: none;
        }

        /* Cuerpo: Solo bordes inferiores suaves para separar filas */
        td {
            padding: 12px 8px;
            text-align: center;
            background-color: white;
            border-bottom: 1px solid #eaeef2;
            color: #2a3b4e;
            transition: background-color 0.2s ease, color 0.2s ease;
        }

        /* Alinear a la izquierda los nombres (primer columna) para facilitar lectura */
        td:first-child {
            text-align: left;
            font-weight: 450;
            padding-left: 18px;
            color: #1f3a57;
            border-right: 1px dashed #d9e2e9; /* Separador muy sutil */
            white-space: nowrap;
        }

        /* Destacar la columna TOTAL siguiendo principio de "punto de entrada" */
        td:last-child {
            font-weight: 700;
            background-color: #f7f9fc; /* Gris azulado muy clarito */
            border-left: 1px solid #cbd5e1;
            color: #0b2b44;
            font-size: 1rem;
        }

        th:last-child {
            background-color: #1f3a57; /* Un tono m√°s oscuro para el total */
            color: white;
        }

        /* --- APLICANDO COLOR CON INTENCI√ìN (HEATMAP SUAVE) --- */
        /* Escala de azules para los valores num√©ricos, inspirado en el uso de color de Knaflic */
        td.value-cell {
            background-color: #f1f7fd; /* Base m√≠nima */
        }

        /* Clases din√°micas para heatmap (se asignan con JS) */
        td.heat-high {
            background-color: #bdd9f0; /* Azul m√°s intenso para valores altos */
            font-weight: 550;
            color: #0f3b5e;
        }

        td.heat-medium {
            background-color: #d6e8f5; /* Azul medio */
            font-weight: 450;
        }

        td.heat-low {
            background-color: #ecf3fa; /* Azul muy suave */
        }

        /* Fila de totales: Debe destacar pero sin robar protagonismo a los datos */
        tr.total-row td {
            background-color: #e3eef9 !important;
            border-top: 2px solid #9bb7d4;
            border-bottom: none;
            font-weight: 600;
            color: #0b2a44;
        }

        tr.total-row td:first-child {
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 0.5px;
            color: #1c4e7c;
        }

        tr.total-row td:last-child {
            background-color: #c1daf2 !important;
            font-size: 1.1rem;
        }

        /* --- INTERACTIVIDAD SUTIL (PRINCIPIO DE ATENCI√ìN DIRIGIDA) --- */
        /* Resaltar fila al pasar el mouse: ayuda a seguir la l√≠nea horizontal */
        tbody tr:hover td {
            background-color: #fcf4e1; /* Color c√°lido y temporal para llamar la atenci√≥n */
            cursor: default;
        }

        tbody tr:hover td:last-child {
            background-color: #f5e6cf; /* Mantener coherencia en total */
        }

        /* Para el heatmap, al hacer hover, respetamos el heat pero con un overlay */
        tbody tr:hover td.heat-high {
            background-color: #d0e2f5; /* M√°s claro que el original pero manteniendo jerarqu√≠a */
        }

        /* Estilo para encabezados clickeables */
        th.sortable {
            cursor: pointer;
            position: relative;
            transition: background-color 0.15s;
        }

        th.sortable:hover {
            background-color: #3f5568; /* Oscurecer al pasar */
        }

        th.sortable::after {
            content: "‚ÜïÔ∏è";
            font-size: 0.7rem;
            margin-left: 6px;
            opacity: 0.6;
            filter: grayscale(1) brightness(10);
        }

        th.sorted-asc::after {
            content: "‚¨ÜÔ∏è" !important;
            opacity: 1;
        }

        th.sorted-desc::after {
            content: "‚¨áÔ∏è" !important;
            opacity: 1;
        }

        /* Peque√±a leyenda */
        .legend {
            display: flex;
            justify-content: flex-end;
            gap: 20px;
            margin-top: 20px;
            font-size: 0.8rem;
            color: #3f5568;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 4px;
        }

        .legend-color.high {
            background-color: #bdd9f0;
            border: 1px solid #8bb3d1;
        }
        .legend-color.medium {
            background-color: #d6e8f5;
        }
        .legend-color.low {
            background-color: #ecf3fa;
        }

        .footer-note {
            text-align: right;
            font-size: 0.7rem;
            color: #7f8fa6;
            margin-top: 8px;
            font-style: italic;
        }

    </style>
</head>
<body>
    <div class="table-container">
        <h2>üìä Desempe√±o individual ¬∑ Gesti√≥n 2025</h2>
        <div class="subtitle">
            üéØ Storytelling con datos: <code>heatmap suave</code> <code>totales destacados</code> <code>orden din√°mico</code> ¬∑ Haz clic en los meses para ordenar.
        </div>

        <table id="data-table">
            <thead>
                <tr>
                    <th>RESPONSABLE</th>
                    <!-- Los meses se generan desde los datos, pero para el HTML fijo lo ponemos manual -->
                </tr>
            </thead>
            <tbody id="table-body">
                <!-- El contenido se inyecta con JS para manejar los datos y el heatmap de forma limpia -->
            </tbody>
        </table>

        <div class="legend">
            <span class="legend-item"><span class="legend-color high"></span> Mayor gesti√≥n</span>
            <span class="legend-item"><span class="legend-color medium"></span> Gesti√≥n media</span>
            <span class="legend-item"><span class="legend-color low"></span> Gesti√≥n baja</span>
            <span class="legend-item"><span style="background:#fcf4e1; width:18px; height:18px; border-radius:4px;"></span> Hover (seguimiento)</span>
        </div>
        <div class="footer-note">
            ‚ö° Haz clic en cualquier mes (Jun, Jul... Dec) para ordenar de mayor a menor ¬∑ Storytelling design by @tech_king
        </div>
    </div>

    <script>
        (function() {
            // --- DATOS PUROS (extra√≠dos del enunciado) ---
            const responsables = [
                "SUSANA GOMEZ", "VICTOR ALFONSO PASILLAS", "MARIO SOLANO", "RODRIGO SALVADOR OLEA",
                "MARIA LETICIA ROMO", "VICTOR CARRILLO", "RICARDO LIMON", "SALVADOR SEGURA",
                "MARIA ELENA ALATORRE", "DAVID VENEGAS", "REY DAVID HERNANDEZ", "ULISES RUIZ",
                "MARIA LUISA GARCIA", "VICTOR MANUEL HERNANDEZ", "ANA FERNANDA HERNANDEZ", "EMILIO BOTELLO",
                "MARIA VANESSA SALCEDO", "CRUZ CASTILLO", "ERIKA ESMERALDA SOLARES", "LUIS MIGUEL ANTONIO ORTIZ",
                "ULISES ALI CONTRERAS", "MARIO ANTONIO ARRIZON", "VIOLETA CORONA", "SOTERO GUTIERREZ",
                "MA JOSEFINA RAMIREZ", "MARIA ANGELICA RODRIGUEZ", "OSCAR GONZALEZ", "ISAAC GABRIEL MORALES",
                "VANESSA ALEJANDRA PARRA", "TERESA GUADALUPE ZARATE"
            ];

            // Datos en el orden: [jun, jul, aug, sep, oct, nov, dec, total]
            const valores = [
                [0,0,3,58,59,43,29,192],
                [0,1,11,51,56,20,34,173],
                [0,0,1,41,37,54,20,153],
                [0,0,2,20,15,43,49,129],
                [0,0,0,13,27,35,21,96],
                [0,0,1,16,25,22,25,89],
                [0,0,1,11,18,26,8,64],
                [0,0,1,16,16,12,18,63],
                [0,0,2,14,17,14,11,58],
                [0,0,1,16,17,13,9,56],
                [0,0,1,14,11,12,10,48],
                [0,0,1,28,8,3,7,47],
                [0,0,0,10,2,16,1,29],
                [0,0,1,4,7,11,2,25],
                [0,0,1,4,8,3,7,23],
                [0,0,0,8,4,4,2,18],
                [0,0,0,5,2,2,6,15],
                [0,0,0,1,2,10,2,15],
                [0,1,0,3,2,1,7,14],
                [0,0,0,3,4,1,3,11],
                [0,0,0,1,1,4,5,11],
                [1,0,0,0,2,0,4,7],
                [0,0,0,0,0,2,5,7],
                [0,0,0,3,1,1,0,5],
                [0,0,0,0,2,0,3,5],
                [0,0,0,0,0,3,2,5],
                [0,0,0,1,0,1,0,2],
                [0,0,0,1,0,1,0,2],
                [0,0,1,0,0,0,0,1],
                [0,0,0,0,0,1,0,1]
            ];

            const meses = ["jun 2025", "jul 2025", "Aug 2025", "sep 2025", "oct 2025", "nov 2025", "Dec 2025", "TOTAL"];

            // Calcular totales por mes (fila final)
            const totalPorMes = [0,0,0,0,0,0,0,1364]; // El total general es 1364
            // Sumamos cada columna
            for (let i = 0; i < valores.length; i++) {
                for (let j = 0; j < 7; j++) { // Solo meses, sin total a√∫n
                    totalPorMes[j] += valores[i][j];
                }
            }
            totalPorMes[7] = 1364; // Aseguramos

            // Referencias al DOM
            const thead = document.querySelector('#data-table thead tr');
            const tbody = document.getElementById('table-body');

            // Renderizar cabecera din√°mica (por si acaso)
            function renderHeader() {
                let headerHtml = '<th>RESPONSABLE</th>';
                meses.forEach((mes, index) => {
                    let className = 'sortable';
                    headerHtml += `<th class="${className}" data-col-index="${index}">${mes}</th>`;
                });
                thead.innerHTML = headerHtml;
            }

            // Funci√≥n para asignar clase heat seg√∫n el valor (basado en el total de la tabla)
            function getHeatClass(valor, maxEnColumna = 60) {
                // El max ronda 50-60 para meses individuales (excepto total)
                if (valor >= 30) return 'heat-high';
                if (valor >= 10) return 'heat-medium';
                if (valor > 0) return 'heat-low';
                return ''; // Cero, sin color
            }

            // Funci√≥n para renderizar el cuerpo con un orden dado (por columna, descendente)
            function renderBody(orderByColIndex = null, orderDesc = true) {
                // Preparamos los datos: array de objetos
                let dataRows = responsables.map((nombre, idx) => {
                    return {
                        nombre: nombre,
                        valores: [...valores[idx]] // copia
                    };
                });

                // Ordenar si se pide (solo si es columna de mes o total)
                if (orderByColIndex !== null && orderByColIndex >= 0 && orderByColIndex < 8) {
                    dataRows.sort((a, b) => {
                        let valA = a.valores[orderByColIndex];
                        let valB = b.valores[orderByColIndex];
                        if (orderDesc) {
                            return valB - valA; // mayor a menor
                        } else {
                            return valA - valB;
                        }
                    });
                }

                // Construir filas
                let html = '';
                for (let i = 0; i < dataRows.length; i++) {
                    const row = dataRows[i];
                    html += '<tr>';
                    html += `<td>${row.nombre}</td>`;

                    // Celdas de meses (0 a 6)
                    for (let m = 0; m < 7; m++) {
                        const val = row.valores[m];
                        const heatClass = getHeatClass(val);
                        html += `<td class="value-cell ${heatClass}">${val}</td>`;
                    }
                    // Celda total (√≠ndice 7)
                    const totalVal = row.valores[7];
                    const heatTotal = totalVal >= 100 ? 'heat-high' : (totalVal >= 40 ? 'heat-medium' : 'heat-low');
                    html += `<td class="${heatTotal}">${totalVal}</td>`;

                    html += '</tr>';
                }

                // A√±adir fila de totales por mes
                html += '<tr class="total-row">';
                html += '<td>TOTAL POR MES</td>';
                for (let m = 0; m < 7; m++) {
                    html += `<td>${totalPorMes[m]}</td>`;
                }
                html += `<td>${totalPorMes[7]}</td>`;
                html += '</tr>';

                tbody.innerHTML = html;
            }

            // Inicializar tabla
            renderHeader();
            renderBody(null); // orden original

            // Agregar eventos de ordenamiento a los encabezados
            document.querySelectorAll('th.sortable').forEach(th => {
                th.addEventListener('click', function() {
                    const colIndex = parseInt(this.dataset.colIndex);
                    // Quitar clases de orden de todos
                    document.querySelectorAll('th.sortable').forEach(h => {
                        h.classList.remove('sorted-asc', 'sorted-desc');
                    });
                    // Por defecto orden descendente (mayor a menor)
                    this.classList.add('sorted-desc');
                    renderBody(colIndex, true);
                });
            });

            // Opcional: restaurar orden original con doble clic en "RESPONSABLE"
            document.querySelector('th:first-child').addEventListener('dblclick', function() {
                document.querySelectorAll('th.sortable').forEach(h => {
                    h.classList.remove('sorted-asc', 'sorted-desc');
                });
                renderBody(null);
            });

            // A√±adir tooltip sutil
            document.querySelector('th:first-child').title = "Doble clic para orden original";

        })();
    </script>
</body>
</html>