<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registros de Urgencias sin Folio de Lesi√≥n</title>
    <style>
        /* --- ESTILOS PARA NARRATIVA DE ALERTA (ROJO = MALO) --- */
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Inter', system-ui, sans-serif;
        }

        body {
            background: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 20px;
            padding: 0;
        }

        .table-container {
            width: 100%;
            max-width: 1300px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 35px rgba(0,0,0,0.15);
            padding: 25px;
            border: 1px solid #ffe0e0; /* borde rojo muy sutil */
        }

        h2 {
            font-weight: 600;
            font-size: 1.9rem;
            color: #b22222; /* rojo ladrillo */
            margin: 0 0 5px 0;
            letter-spacing: -0.02em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h2 span {
            background: #b22222;
            color: white;
            font-size: 0.9rem;
            padding: 5px 12px;
            border-radius: 30px;
            font-weight: 400;
        }

        .subtitle {
            color: #a13a3a;
            margin-top: 0;
            margin-bottom: 25px;
            font-size: 1rem;
            border-left: 5px solid #c0392b;
            padding-left: 18px;
            background: #fff3f0;
            border-radius: 0 10px 10px 0;
            line-height: 1.5;
            width: fit-content;
            padding: 10px 25px;
            font-weight: 400;
        }

        .subtitle strong {
            color: #a52626;
            font-weight: 600;
        }

        /* --- TABLA SIN BORDES, PERO CON SENSACI√ìN DE URGENCIA --- */
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(185, 50, 50, 0.1);
        }

        /* Cabecera: rojo oscuro para denotar gravedad */
        th {
            background-color: #78281f; /* rojo oscuro profundo */
            color: white;
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.7px;
            padding: 16px 8px;
            white-space: nowrap;
            text-align: center;
            border-right: 1px solid #9e4a3e;
        }

        th:last-child {
            border-right: none;
        }

        /* Nombres a la izquierda */
        td:first-child {
            text-align: left;
            font-weight: 500;
            padding-left: 18px;
            color: #2c3e50;
            border-right: 1px dashed #e6b8b8;
            white-space: nowrap;
        }

        /* La columna total ahora es la de "acumulado de faltas" - la m√°s cr√≠tica */
        td:last-child {
            font-weight: 700;
            background-color: #fef5f5; /* fondo rosa muy suave */
            border-left: 2px solid #c0392b; /* l√≠nea roja de advertencia */
            color: #a52626;
            font-size: 1rem;
        }

        th:last-child {
            background-color: #641e16; /* a√∫n m√°s oscuro */
            color: white;
            position: relative;
        }
        th:last-child::before {
            content: "‚ö†Ô∏è";
            margin-right: 6px;
            font-size: 1rem;
        }

        /* --- HEATMAP DE PELIGRO: ROJO = MALO (m√°s registros faltantes) --- */
        td.value-cell {
            background-color: #fff6f6; /* base neutra */
        }

        /* Mientras m√°s alto el n√∫mero, m√°s rojo intenso (peor desempe√±o) */
        td.heat-critical {
            background-color: #c0392b !important; /* rojo fuerte */
            color: white;
            font-weight: 700;
        }
        td.heat-high {
            background-color: #e67e22 !important; /* naranja intenso */
            color: white;
            font-weight: 600;
        }
        td.heat-medium {
            background-color: #f39c12 !important; /* naranja/amarillo */
            color: #1e1e1e;
        }
        td.heat-low {
            background-color: #fde6e6 !important; /* rojo muy clarito */
            color: #4a2c2c;
        }
        /* Cero (lo correcto) se queda sin color o gris muy neutro */
        td.heat-zero {
            background-color: #f2f5f7; /* gris azulado fr√≠o - neutral, cero faltas */
            color: #3d5a73;
            font-weight: 400;
        }

        /* Fila de totales por mes: debe reflejar el problema acumulado */
        tr.total-row td {
            background-color: #f9e1e1 !important;
            border-top: 3px solid #b03a2e;
            border-bottom: none;
            font-weight: 700;
            color: #591f1f;
        }

        tr.total-row td:first-child {
            font-weight: 800;
            text-transform: uppercase;
            font-size: 0.85rem;
            color: #7b241c;
        }

        tr.total-row td:last-child {
            background-color: #d98880 !important; /* rojo m√°s fuerte en total general */
            color: white;
            font-size: 1.2rem;
        }

        /* Hover: para seguir la fila, pero con un tono que no compita con el rojo */
        tbody tr:hover td {
            background-color: #fff1d6; /* durazno suave */
            transition: background-color 0.15s;
        }
        /* Respetar jerarqu√≠a de calor en hover (mezclar colores) */
        tbody tr:hover td.heat-critical {
            background-color: #b03a2e !important;
        }
        tbody tr:hover td.heat-high {
            background-color: #d5671a !important;
        }

        /* Encabezados clickeables */
        th.sortable {
            cursor: pointer;
            transition: background-color 0.15s;
        }
        th.sortable:hover {
            background-color: #9e4a3e;
        }
        th.sortable::after {
            content: " ‚ÜïÔ∏è";
            font-size: 0.7rem;
            opacity: 0.7;
            filter: grayscale(0.5);
        }

        /* Leyenda actualizada */
        .legend {
            display: flex;
            justify-content: flex-end;
            gap: 20px;
            margin-top: 20px;
            font-size: 0.8rem;
            color: #78281f;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            background: #fff0f0;
            padding: 4px 12px;
            border-radius: 30px;
        }
        .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 4px;
        }
        .critical { background-color: #c0392b; }
        .high { background-color: #e67e22; }
        .medium { background-color: #f39c12; }
        .low { background-color: #fde6e6; border: 1px solid #dba1a1; }
        .zero { background-color: #f2f5f7; border: 1px dashed #7f8c8d; }

        .footer-note {
            text-align: right;
            font-size: 0.75rem;
            color: #ac5f5f;
            margin-top: 10px;
            font-style: italic;
            border-top: 1px dashed #dbb0b0;
            padding-top: 10px;
        }
    </style>
</head>
<body>
    <div class="table-container">
        <h2>
            Urgencias Sin Folio de Lesi√≥n
            <span>Recurrente!</span>
        </h2>
        <div class="subtitle">
            <strong>‚ö†Ô∏è OBSERVACIONES:</strong>
        </div>

        <table id="data-table">
            <thead>
                <tr>
                    <th>RESPONSABLE</th>
                    <!-- Se llena con JS -->
                </tr>
            </thead>
            <tbody id="table-body">
                <!-- JS inyecta -->
            </tbody>
        </table>

        <div class="legend">
            <span class="legend-item"><span class="legend-color critical"></span> Cr√≠tico (‚â•50)</span>
            <span class="legend-item"><span class="legend-color high"></span> Muy alto (30-49)</span>
            <span class="legend-item"><span class="legend-color medium"></span> Moderado (15-29)</span>
            <span class="legend-item"><span class="legend-color low"></span> Leve (1-14)</span>
            <span class="legend-item"><span class="legend-color zero"></span> Correcto (0)</span>
        </div>
        <div class="footer-note">
            üî¥ El rojo indica gravedad ¬∑ Ordena por mes para ver qui√©n incumple m√°s
        </div>
    </div>

    <script>
        (function() {
            // Datos exactos del problema
            const responsables = [
                "SUSANA GOMEZ", "VICTOR ALFONSO PASILLAS", "MARIO SOLANO", "RODRIGO SALVADOR OLEA",
                "MARIA LETICIA ROMO", "VICTOR CARRILLO", "RICARDO LIMON", "SALVADOR SEGURA",
                "MARIA ELENA ALATORRE", "DAVID VENEGAS", "REY DAVID HERNANDEZ", "ULISES RUIZ",
                "MARIA LUISA GARCIA", "VICTOR MANUEL HERNANDEZ", "ANA FERNANDA HERNANDEZ", "EMILIO BOTELLO",
                "MARIA VANESSA SALCEDO", "CRUZ CASTILLO", "ERIKA ESMERALDA SOLARES", "LUIS MIGUEL ANTONIO ORTIZ",
                "ULISES ALI CONTRERAS", "MARIO ANTONIO ARRIZON", "VIOLETA CORONA", "SOTERO GUTIERREZ",
                "MA JOSEFINA RAMIREZ", "MARIA ANGELICA RODRIGUEZ", "OSCAR GONZALEZ", "ISAAC GABRIEL MORALES",
                "VANESSA ALEJANDRA PARRA", "TERESA GUADALUPE ZARATE"
            ];

            const valores = [
                [0,0,3,58,59,43,29,192],
                [0,1,11,51,56,20,34,173],
                [0,0,1,41,37,54,20,153],
                [0,0,2,20,15,43,49,129],
                [0,0,0,13,27,35,21,96],
                [0,0,1,16,25,22,25,89],
                [0,0,1,11,18,26,8,64],
                [0,0,1,16,16,12,18,63],
                [0,0,2,14,17,14,11,58],
                [0,0,1,16,17,13,9,56],
                [0,0,1,14,11,12,10,48],
                [0,0,1,28,8,3,7,47],
                [0,0,0,10,2,16,1,29],
                [0,0,1,4,7,11,2,25],
                [0,0,1,4,8,3,7,23],
                [0,0,0,8,4,4,2,18],
                [0,0,0,5,2,2,6,15],
                [0,0,0,1,2,10,2,15],
                [0,1,0,3,2,1,7,14],
                [0,0,0,3,4,1,3,11],
                [0,0,0,1,1,4,5,11],
                [1,0,0,0,2,0,4,7],
                [0,0,0,0,0,2,5,7],
                [0,0,0,3,1,1,0,5],
                [0,0,0,0,2,0,3,5],
                [0,0,0,0,0,3,2,5],
                [0,0,0,1,0,1,0,2],
                [0,0,0,1,0,1,0,2],
                [0,0,1,0,0,0,0,1],
                [0,0,0,0,0,1,0,1]
            ];

            const meses = ["jun 2025", "jul 2025", "Aug 2025", "sep 2025", "oct 2025", "nov 2025", "Dec 2025", "TOTAL"];
            
            // Calcular totales por mes
            const totalPorMes = [0,0,0,0,0,0,0,1364];
            for (let i = 0; i < valores.length; i++) {
                for (let j = 0; j < 7; j++) {
                    totalPorMes[j] += valores[i][j];
                }
            }
            totalPorMes[7] = 1364;

            // Renderizado
            const thead = document.querySelector('#data-table thead tr');
            const tbody = document.getElementById('table-body');

            function renderHeader() {
                let headerHtml = '<th>RESPONSABLE</th>';
                meses.forEach((mes, index) => {
                    headerHtml += `<th class="sortable" data-col-index="${index}">${mes}</th>`;
                });
                thead.innerHTML = headerHtml;
            }

            // Clase de calor basada en gravedad (rojo = malo)
            function getHeatClass(valor) {
                if (valor === 0) return 'heat-zero';
                if (valor >= 50) return 'heat-critical';
                if (valor >= 30) return 'heat-high';
                if (valor >= 15) return 'heat-medium';
                if (valor >= 1) return 'heat-low';
                return 'heat-zero';
            }

            function renderBody(orderByColIndex = null, orderDesc = true) {
                let dataRows = responsables.map((nombre, idx) => ({
                    nombre: nombre,
                    valores: [...valores[idx]]
                }));

                if (orderByColIndex !== null && orderByColIndex >= 0 && orderByColIndex < 8) {
                    dataRows.sort((a, b) => {
                        let valA = a.valores[orderByColIndex];
                        let valB = b.valores[orderByColIndex];
                        return orderDesc ? valB - valA : valA - valB;
                    });
                }

                let html = '';
                for (let row of dataRows) {
                    html += '<tr>';
                    html += `<td>${row.nombre}</td>`;
                    for (let m = 0; m < 7; m++) {
                        const val = row.valores[m];
                        html += `<td class="value-cell ${getHeatClass(val)}">${val}</td>`;
                    }
                    // Total
                    const totalVal = row.valores[7];
                    html += `<td class="${getHeatClass(totalVal)}">${totalVal}</td>`;
                    html += '</tr>';
                }

                // Fila totales
                html += '<tr class="total-row">';
                html += '<td>TOTAL POR MES (incumplimientos)</td>';
                for (let m = 0; m < 7; m++) {
                    html += `<td class="${getHeatClass(totalPorMes[m])}">${totalPorMes[m]}</td>`;
                }
                html += `<td class="${getHeatClass(totalPorMes[7])}">${totalPorMes[7]}</td>`;
                html += '</tr>';

                tbody.innerHTML = html;
            }

            // Inicializar
            renderHeader();
            renderBody(null);

            // Eventos de ordenamiento
            document.querySelectorAll('th.sortable').forEach(th => {
                th.addEventListener('click', function() {
                    const colIndex = parseInt(this.dataset.colIndex);
                    document.querySelectorAll('th.sortable').forEach(h => {
                        h.classList.remove('sorted-asc', 'sorted-desc');
                    });
                    this.classList.add('sorted-desc');
                    renderBody(colIndex, true);
                });
            });

            // Doble clic en responsable para volver al original
            document.querySelector('th:first-child').addEventListener('dblclick', function() {
                document.querySelectorAll('th.sortable').forEach(h => {
                    h.classList.remove('sorted-asc', 'sorted-desc');
                });
                renderBody(null);
            });

            // Tooltip
            document.querySelector('th:first-child').title = "Doble clic para orden original";
        })();
    </script>
</body>
</html>