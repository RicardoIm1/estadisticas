<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de H치bitos</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Tus estilos aqu칤 */
        body { font-family: Arial, sans-serif; padding: 20px; }
        .chart-container { height: 300px; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>游늵 Dashboard de H치bitos</h1>
    
    <div class="chart-container">
        <canvas id="myChart"></canvas>
    </div>
    
    <div id="data-table"></div>
    
    <script>
        // CONFIGURACI칍N - REEMPLAZA ESTO:
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzYoUt1CJu7mmh0KI03G_gbV1dgjsP8L0WCtJVDnOG6pTba8O52TP_9Xl9HLXuO65Br/exec'; // Tu URL aqu칤
        
        // Funci칩n principal
        async function loadData() {
            try {
                console.log('Cargando datos desde:', APPS_SCRIPT_URL);
                
                // Para Apps Script, necesitamos usar 'no-cors' o proxy
                const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                const response = await fetch(proxyUrl + APPS_SCRIPT_URL);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                
                if (result.success) {
                    displayData(result.data);
                    createChart(result.data);
                } else {
                    throw new Error(result.error);
                }
                
            } catch (error) {
                console.error('Error cargando datos:', error);
                document.getElementById('data-table').innerHTML = 
                    `<p style="color: red;">Error cargando datos: ${error.message}</p>
                     <p>Usando datos de ejemplo...</p>`;
                loadSampleData();
            }
        }
        
        function displayData(data) {
            let tableHTML = '<table border="1" cellpadding="10">';
            
            // Encabezados
            tableHTML += '<tr>';
            data[0].forEach(header => {
                tableHTML += `<th>${header}</th>`;
            });
            tableHTML += '</tr>';
            
            // Filas
            for (let i = 1; i < Math.min(data.length, 10); i++) {
                tableHTML += '<tr>';
                data[i].forEach(cell => {
                    tableHTML += `<td>${cell}</td>`;
                });
                tableHTML += '</tr>';
            }
            
            tableHTML += '</table>';
            document.getElementById('data-table').innerHTML = tableHTML;
        }
        
        function createChart(data) {
            // Extraer datos para el gr치fico
            const ctx = document.getElementById('myChart').getContext('2d');
            
            // Suponiendo que la columna 1 es "Calidad de Vida"
            const labels = data.slice(1).map((row, index) => `D칤a ${index + 1}`);
            const values = data.slice(1).map(row => parseInt(row[1]) || 0);
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Calidad de Vida',
                        data: values,
                        borderColor: 'rgb(75, 192, 192)',
                        tension: 0.1
                    }]
                }
            });
        }
        
        function loadSampleData() {
            const sampleData = [
                ['Fecha', 'Calidad de Vida', 'Horas de Sue침o'],
                ['2024-01-01', 8, 7.5],
                ['2024-01-02', 7, 6.5],
                ['2024-01-03', 9, 8.0]
            ];
            displayData(sampleData);
            createChart(sampleData);
        }
        
        // Iniciar cuando la p치gina cargue
        document.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>