<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hoja de Ruta Técnica · Proyecto GAS</title>

<style>
:root{
  --primary:#2563eb;
  --bg:#f8fafc;
  --card:#ffffff;
  --border:#e2e8f0;
  --text:#1e293b;
  --muted:#64748b;
  --success:#16a34a;
}

*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto;}

body{
  background:var(--bg);
  color:var(--text);
  line-height:1.6;
  padding:20px;
}

header{
  margin-bottom:20px;
}

h1{
  font-size:1.6rem;
  margin-bottom:10px;
}

.progress-container{
  background:var(--border);
  border-radius:8px;
  overflow:hidden;
  height:10px;
}

.progress-bar{
  height:100%;
  width:0%;
  background:var(--success);
  transition:width .3s ease;
}

.tabs{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin:20px 0;
}

.tab-btn{
  padding:8px 14px;
  border-radius:6px;
  border:1px solid var(--border);
  background:var(--card);
  cursor:pointer;
  font-size:.9rem;
}

.tab-btn.active{
  background:var(--primary);
  color:white;
  border-color:var(--primary);
}

.tab-content{
  display:none;
}

.tab-content.active{
  display:block;
}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:10px;
  padding:15px;
  margin-bottom:15px;
}

.accordion{
  cursor:pointer;
  padding:10px;
  border-radius:6px;
  background:var(--bg);
  border:1px solid var(--border);
  font-weight:600;
  margin-top:10px;
}

.panel{
  max-height:0;
  overflow:hidden;
  transition:max-height .3s ease;
  padding-left:10px;
}

.panel ul{
  list-style:none;
  padding:10px 0;
}

.panel li{
  margin-bottom:6px;
}

label{
  display:flex;
  align-items:center;
  gap:8px;
  font-size:.9rem;
  cursor:pointer;
}

small{
  color:var(--muted);
}

@media (min-width:768px){
  body{max-width:1000px;margin:auto;}
}
</style>
</head>

<body>

<header>
<h1>Hoja de Ruta Técnica · Reestructura Proyecto GAS</h1>
<small>Documento operativo para implementación progresiva</small>
<div class="progress-container">
<div class="progress-bar" id="progressBar"></div>
</div>
</header>

<div class="tabs">
<button class="tab-btn active" data-tab="arquitectura">Arquitectura</button>
<button class="tab-btn" data-tab="sesiones">Sesiones</button>
<button class="tab-btn" data-tab="frontend">Frontend</button>
<button class="tab-btn" data-tab="seguridad">Seguridad</button>
<button class="tab-btn" data-tab="deploy">Deploy</button>
</div>

<!-- ARQUITECTURA -->
<div class="tab-content active" id="arquitectura">

<div class="card">
<div class="accordion">Estructura Base del Sistema</div>
<div class="panel">
<ul>
<li><label><input type="checkbox"> Consolidar arquitectura modular (index.html como contenedor principal)</label></li>
<li><label><input type="checkbox"> Mantener redirección por UUID de rol</label></li>
<li><label><input type="checkbox"> Backend separado en main.gs y auth.gs</label></li>
<li><label><input type="checkbox"> Validación de acceso por id_t_usuario desde BigQuery</label></li>
<li><label><input type="checkbox"> Eliminar archivos HTML redundantes</label></li>
</ul>
</div>
</div>

<div class="card">
<div class="accordion">Base de Datos</div>
<div class="panel">
<ul>
<li><label><input type="checkbox"> Validar conexión BigQuery proyecto hallowed-tape-459314-d3</label></li>
<li><label><input type="checkbox"> Confirmar columnas: id_usuario, nombre, curp, celular, id_clues, id_t_usuario, activo</label></li>
<li><label><input type="checkbox"> Validar filtros por región sanitaria</label></li>
<li><label><input type="checkbox"> Crear consultas optimizadas para login</label></li>
</ul>
</div>
</div>

</div>

<!-- SESIONES -->
<div class="tab-content" id="sesiones">

<div class="card">
<div class="accordion">Sistema de Login</div>
<div class="panel">
<ul>
<li><label><input type="checkbox"> Login solo con CURP + celular</label></li>
<li><label><input type="checkbox"> Redirección correcta a index.html</label></li>
<li><label><input type="checkbox"> Bloquear acceso si activo = false</label></li>
<li><label><input type="checkbox"> Manejo de errores consistente</label></li>
</ul>
</div>
</div>

<div class="card">
<div class="accordion">Persistencia de Sesión</div>
<div class="panel">
<ul>
<li><label><input type="checkbox"> Implementar obtenerSesionCompleta()</label></li>
<li><label><input type="checkbox"> Evitar redirecciones erráticas</label></li>
<li><label><input type="checkbox"> Validar sesión antes de cargar formularios</label></li>
<li><label><input type="checkbox"> Logout limpio</label></li>
</ul>
</div>
</div>

</div>

<!-- FRONTEND -->
<div class="tab-content" id="frontend">

<div class="card">
<div class="accordion">Compatibilidad</div>
<div class="panel">
<ul>
<li><label><input type="checkbox"> Eliminar backticks problemáticos</label></li>
<li><label><input type="checkbox"> Compatibilidad Safari iOS</label></li>
<li><label><input type="checkbox"> Evitar doble menú en pantallas grandes</label></li>
<li><label><input type="checkbox"> CSS responsive consistente</label></li>
</ul>
</div>
</div>

<div class="card">
<div class="accordion">UX Funcional</div>
<div class="panel">
<ul>
<li><label><input type="checkbox"> Animación visual al guardar registro</label></li>
<li><label><input type="checkbox"> Indicador de progreso en formularios</label></li>
<li><label><input type="checkbox"> Terminal visual solo en desktop</label></li>
<li><label><input type="checkbox"> Validaciones claras y visibles</label></li>
</ul>
</div>
</div>

</div>

<!-- SEGURIDAD -->
<div class="tab-content" id="seguridad">

<div class="card">
<div class="accordion">Control de Accesos</div>
<div class="panel">
<ul>
<li><label><input type="checkbox"> Validación backend obligatoria</label></li>
<li><label><input type="checkbox"> Evitar ejecución arbitraria en GAS</label></li>
<li><label><input type="checkbox"> Sanitizar entradas</label></li>
<li><label><input type="checkbox"> Registrar logs críticos</label></li>
</ul>
</div>
</div>

<div class="card">
<div class="accordion">Hardening</div>
<div class="panel">
<ul>
<li><label><input type="checkbox"> Limitar métodos expuestos</label></li>
<li><label><input type="checkbox"> Revisión de permisos en Apps Script</label></li>
<li><label><input type="checkbox"> Validar roles en cada operación</label></li>
</ul>
</div>
</div>

</div>

<!-- DEPLOY -->
<div class="tab-content" id="deploy">

<div class="card">
<div class="accordion">GitHub Pages</div>
<div class="panel">
<ul>
<li><label><input type="checkbox"> Verificar rutas relativas</label></li>
<li><label><input type="checkbox"> Evitar errores net::ERR_NAME_NOT_RESOLVED</label></li>
<li><label><input type="checkbox"> Versionado limpio</label></li>
<li><label><input type="checkbox"> Pruebas cross-browser finales</label></li>
</ul>
</div>
</div>

</div>

<script>
// Tabs
document.querySelectorAll(".tab-btn").forEach(btn=>{
  btn.addEventListener("click",()=>{
    document.querySelectorAll(".tab-btn").forEach(b=>b.classList.remove("active"));
    document.querySelectorAll(".tab-content").forEach(c=>c.classList.remove("active"));
    btn.classList.add("active");
    document.getElementById(btn.dataset.tab).classList.add("active");
  });
});

// Accordions
document.querySelectorAll(".accordion").forEach(acc=>{
  acc.addEventListener("click",()=>{
    const panel=acc.nextElementSibling;
    panel.style.maxHeight?panel.style.maxHeight=null:panel.style.maxHeight=panel.scrollHeight+"px";
  });
});

// Progress + Persistence
const checkboxes=document.querySelectorAll("input[type='checkbox']");
const progressBar=document.getElementById("progressBar");

function updateProgress(){
  const total=checkboxes.length;
  const checked=document.querySelectorAll("input[type='checkbox']:checked").length;
  const percent=(checked/total)*100;
  progressBar.style.width=percent+"%";
  localStorage.setItem("roadmapProgress",JSON.stringify(
    [...checkboxes].map(cb=>cb.checked)
  ));
}

function loadProgress(){
  const saved=JSON.parse(localStorage.getItem("roadmapProgress"));
  if(saved){
    checkboxes.forEach((cb,i)=>cb.checked=saved[i]);
  }
  updateProgress();
}

checkboxes.forEach(cb=>cb.addEventListener("change",updateProgress));

loadProgress();
</script>

</body>
</html>
